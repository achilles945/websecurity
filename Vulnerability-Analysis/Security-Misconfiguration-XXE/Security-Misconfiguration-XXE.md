# Security Misconfiguration XXE

## Vulnerability Report


## Logs

### XXE File Upload Check

#### Request

POST /file-upload HTTP/1.1
Host: localhost:3000
Content-Length: 366
sec-ch-ua-platform: "Linux"
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MSwidXNlcm5hbWUiOiIiLCJlbWFpbCI6ImFkbWluQGp1aWNlLXNoLm9wIiwicGFzc3dvcmQiOiIwMTkyMDIzYTdiYmQ3MzI1MDUxNmYwNjlkZjE4YjUwMCIsInJvbGUiOiJhZG1pbiIsImRlbHV4ZVRva2VuIjoiIiwibGFzdExvZ2luSXAiOiJ1bmRlZmluZWQiLCJwcm9maWxlSW1hZ2UiOiJhc3NldHMvcHVibGljL2ltYWdlcy91cGxvYWRzL2RlZmF1bHRBZG1pbi5wbmciLCJ0b3RwU2VjcmV0IjoiIiwiaXNBY3RpdmUiOnRydWUsImNyZWF0ZWRBdCI6IjIwMjUtMDMtMzEgMTg6MTM6MTcuMjQ1ICswMDowMCIsInVwZGF0ZWRBdCI6IjIwMjUtMDMtMzEgMjE6Mzg6MTcuNDgzICswMDowMCIsImRlbGV0ZWRBdCI6bnVsbH0sImlhdCI6MTc0MzQ2MDczNX0.vNrzNy_yyQ9SxzsWAlScAh9vAfwL-F6eUX8w6cKFEF0tY-OLYIDcmwZ-ijZP5RaU8XdxBYhDu8PNJPw19ZRG5Adbm78piGzD1841BpUw-oLmsTaSrJ_pZWT0fS5o1AWbHbz4PjaT2Ri1quzNpJpUwGVzWCSTAzQupyNRjmNCabY
Accept-Language: en-US,en;q=0.9
sec-ch-ua: "Not?A_Brand";v="99", "Chromium";v="130"
Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydAtxzmUm96iy9hBP
sec-ch-ua-mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.70 Safari/537.36
Accept: */*
Origin: http://localhost:3000
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: http://localhost:3000/
Accept-Encoding: gzip, deflate, br
Cookie: welcomebanner_status=dismiss; cookieconsent_status=dismiss; language=en; continueCode=3eVNn1B3mREPYLxz6JjalokwMA4VfvkubgG2gOWXe4b87yrpDV95ZvKQqWaQ; token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJzdWNjZXNzIiwiZGF0YSI6eyJpZCI6MSwidXNlcm5hbWUiOiIiLCJlbWFpbCI6ImFkbWluQGp1aWNlLXNoLm9wIiwicGFzc3dvcmQiOiIwMTkyMDIzYTdiYmQ3MzI1MDUxNmYwNjlkZjE4YjUwMCIsInJvbGUiOiJhZG1pbiIsImRlbHV4ZVRva2VuIjoiIiwibGFzdExvZ2luSXAiOiJ1bmRlZmluZWQiLCJwcm9maWxlSW1hZ2UiOiJhc3NldHMvcHVibGljL2ltYWdlcy91cGxvYWRzL2RlZmF1bHRBZG1pbi5wbmciLCJ0b3RwU2VjcmV0IjoiIiwiaXNBY3RpdmUiOnRydWUsImNyZWF0ZWRBdCI6IjIwMjUtMDMtMzEgMTg6MTM6MTcuMjQ1ICswMDowMCIsInVwZGF0ZWRBdCI6IjIwMjUtMDMtMzEgMjE6Mzg6MTcuNDgzICswMDowMCIsImRlbGV0ZWRBdCI6bnVsbH0sImlhdCI6MTc0MzQ2MDczNX0.vNrzNy_yyQ9SxzsWAlScAh9vAfwL-F6eUX8w6cKFEF0tY-OLYIDcmwZ-ijZP5RaU8XdxBYhDu8PNJPw19ZRG5Adbm78piGzD1841BpUw-oLmsTaSrJ_pZWT0fS5o1AWbHbz4PjaT2Ri1quzNpJpUwGVzWCSTAzQupyNRjmNCabY
Connection: keep-alive

------WebKitFormBoundarydAtxzmUm96iy9hBP
Content-Disposition: form-data; name="file"; filename="payload.xml"
Content-Type: text/xml

<?xml version="1.0" encoding="ISO-8859-1"?>

<user>
    <username>foo<</username>
    <password>Un6R34kb!e</password>
    <userid>500</userid>
    <mail>s4tan@hell.com</mail>
</user>

------WebKitFormBoundarydAtxzmUm96iy9hBP--


#### Response

HTTP/1.1 410 Gone
Access-Control-Allow-Origin: *
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
Feature-Policy: payment 'self'
X-Recruiting: /#/jobs
Content-Type: text/html; charset=utf-8
Vary: Accept-Encoding
Date: Mon, 31 Mar 2025 22:40:06 GMT
Connection: keep-alive
Keep-Alive: timeout=5
Content-Length: 3319

<html>
  <head>
    <meta charset='utf-8'> 
    <title>Error: B2B customer complaints via file upload have been deprecated for security reasons: StartTag: invalid element name (Line: 4, Column: 19) (payload.xml)</title>
    <style>* {
  margin: 0;
  padding: 0;
  outline: 0;
}

body {
  padding: 80px 100px;
  font: 13px "Helvetica Neue", "Lucida Grande", "Arial";
  background: #ECE9E9 -webkit-gradient(linear, 0% 0%, 0% 100%, from(#fff), to(#ECE9E9));
  background: #ECE9E9 -moz-linear-gradient(top, #fff, #ECE9E9);
  background-repeat: no-repeat;
  color: #555;
  -webkit-font-smoothing: antialiased;
}
h1, h2 {
  font-size: 22px;
  color: #343434;
}
h1 em, h2 em {
  padding: 0 5px;
  font-weight: normal;
}
h1 {
  font-size: 60px;
}
h2 {
  margin-top: 10px;
}
ul li {
  list-style: none;
}
#stacktrace {
  margin-left: 60px;
}
</style>
  </head>
  <body>
    <div id="wrapper">
      <h1>OWASP Juice Shop (Express ^4.21.0)</h1>
      <h2><em>410</em> Error: B2B customer complaints via file upload have been deprecated for security reasons: StartTag: invalid element name (Line: 4, Column: 19) (payload.xml)</h2>
      <ul id="stacktrace"><li> &nbsp; &nbsp;at handleXmlUpload (/juice-shop/build/routes/fileUpload.js:126:26)</li><li> &nbsp; &nbsp;at Layer.handle [as handle_request] (/juice-shop/node_modules/express/lib/router/layer.js:95:5)</li><li> &nbsp; &nbsp;at next (/juice-shop/node_modules/express/lib/router/route.js:149:13)</li><li> &nbsp; &nbsp;at handleZipFileUpload (/juice-shop/build/routes/fileUpload.js:86:9)</li><li> &nbsp; &nbsp;at Layer.handle [as handle_request] (/juice-shop/node_modules/express/lib/router/layer.js:95:5)</li><li> &nbsp; &nbsp;at next (/juice-shop/node_modules/express/lib/router/route.js:149:13)</li><li> &nbsp; &nbsp;at checkFileType (/juice-shop/build/routes/fileUpload.js:100:5)</li><li> &nbsp; &nbsp;at Layer.handle [as handle_request] (/juice-shop/node_modules/express/lib/router/layer.js:95:5)</li><li> &nbsp; &nbsp;at next (/juice-shop/node_modules/express/lib/router/route.js:149:13)</li><li> &nbsp; &nbsp;at checkUploadSize (/juice-shop/build/routes/fileUpload.js:93:5)</li><li> &nbsp; &nbsp;at Layer.handle [as handle_request] (/juice-shop/node_modules/express/lib/router/layer.js:95:5)</li><li> &nbsp; &nbsp;at next (/juice-shop/node_modules/express/lib/router/route.js:149:13)</li><li> &nbsp; &nbsp;at /juice-shop/build/routes/metrics.js:82:9</li><li> &nbsp; &nbsp;at Layer.handle [as handle_request] (/juice-shop/node_modules/express/lib/router/layer.js:95:5)</li><li> &nbsp; &nbsp;at next (/juice-shop/node_modules/express/lib/router/route.js:149:13)</li><li> &nbsp; &nbsp;at ensureFileIsPassed (/juice-shop/build/routes/fileUpload.js:45:9)</li><li> &nbsp; &nbsp;at Layer.handle [as handle_request] (/juice-shop/node_modules/express/lib/router/layer.js:95:5)</li><li> &nbsp; &nbsp;at next (/juice-shop/node_modules/express/lib/router/route.js:149:13)</li><li> &nbsp; &nbsp;at done (/juice-shop/node_modules/multer/lib/make-middleware.js:45:7)</li><li> &nbsp; &nbsp;at indicateDone (/juice-shop/node_modules/multer/lib/make-middleware.js:49:68)</li><li> &nbsp; &nbsp;at Multipart.&lt;anonymous&gt; (/juice-shop/node_modules/multer/lib/make-middleware.js:166:7)</li><li> &nbsp; &nbsp;at Multipart.emit (node:events:519:28)</li></ul>
    </div>
  </body>
</html>
